var V=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var U=(t,n,r)=>n in t?V(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,B=(t,n)=>{for(var r in n||(n={}))W.call(n,r)&&U(t,r,n[r]);if(O)for(var r of O(n))Z.call(n,r)&&U(t,r,n[r]);return t},M=(t,n)=>K(t,Q(n));import{j as d,a as e,L as C,m as D,l as ee,f as te,r as R,R as ne,F as re,b as m,u as H,c as se,T as I,d as ae,e as _,g as L,h as oe,H as ce}from"./vendor.js";const le=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerpolicy&&(l.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?l.credentials="include":s.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}};le();const ie=({id:t,title:n,tags:r,publishDate:c,content:s,toc:l,mode:a})=>{const g=new Date(c),y=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],[f,N,A]=[y[g.getMonth()],g.getDate()+"TH",g.getFullYear()];return d("article",{className:"article post",children:[e("h1",{className:"article-title",children:a?n:e(C,{to:"/post/"+t,children:n})}),e("div",{className:"article-date",children:`${f||""} ${N} ${A||""}`}),e("div",{className:"article-content",children:e("div",{className:"post-body markdown-body",dangerouslySetInnerHTML:{__html:s}})}),e("div",{className:"article-info",children:d("div",{className:"article-tags",children:[e("span",{children:"Tags:"}),r.split("|").map(x=>e(C,{to:"/blog/tag/"+x,className:"article-tags-link",children:x},x))]})})]})};function ue(t){const n=t.filter(s=>s.type==="heading").map(s=>({nodeID:s.text.replace(/<(?:.|\n)*?>/gm,"").toLowerCase().replace(/[\s\n\t]+/g,"-"),nodeLevel:s.depth,childrenNode:[]})),r={nodeID:"root",nodeLevel:0,childrenNode:[]};function c(s,l){let a;s.childrenNode.forEach(g=>{l.nodeLevel>g.nodeLevel&&(a=g)}),a===void 0?s.childrenNode.push(l):c(a,l)}return n.forEach(s=>c(r,s)),r}const $=new D.Renderer;$.heading=(t,n)=>{const r=t.replace(/<(?:.|\n)*?>/gm,"").toLowerCase().replace(/[\s\n\t]+/g,"-");return`<h${n} id="${r}">${t}</h${n}>`};$.code=(t,n)=>{const r=ee.highlightAuto(t).value;return`<pre><code class="lang-${n}">${r}</code></pre>`};D.setOptions({renderer:$,breaks:!0,gfm:!0});function Y(t){const{attributes:n,body:r}=te(t),c=r,s=n,l=D.lexer(c),a=ue(l),g=D.parser(l);return{meta:s,html:g,markdown:c,tocTree:a}}const de="//oss.ksana.net/articles/postList.json",he="//oss.ksana.net/articles/",me=()=>G().then(t=>[...new Set(t.map(n=>n.tags).reduce((n,r)=>n.concat(r)))]),q=()=>G(),fe=async t=>{const r=(await q()).find(c=>c.id==t);return r?await pe(r.file_name):""},pe=t=>R.get(he+t),G=()=>R.get(de).then(t=>t.map(n=>{const r=n.tags.split("|").map(c=>c.trim());return M(B({},n),{tags:r})}));class ge extends ne.Component{constructor(n){super(n);this.state={hasError:!1,error:""},this.setState}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){}render(){return this.state.hasError?d(re,{children:[e("h3",{style:{textAlign:"center"},children:"\u53D1\u751F\u4E86\u67D0\u4E9B\u610F\u5916\uFF0C\u8FD9\u7BC7\u6587\u7AE0\u4E0D\u89C1\u4E86\uFF01"}),e("br",{}),e("p",{style:{color:"#fff"},children:this.state.error.toString()}),e("p",{style:{color:"#fff",maxHeight:300},children:JSON.stringify(this.props.post)})]}):this.props.children}}var ve=()=>{const[t,n]=m.exports.useState(),[r,c]=m.exports.useState(!0),{id:s}=H();return m.exports.useEffect(()=>{!s||fe(Number(s)).then(l=>{try{const a=Y(l);if(!a)return;n(a),c(!1)}catch{}})},[s]),r||!t?e("h3",{style:{textAlign:"center"},children:"Loading..."}):e(ge,{post:t,children:e(ie,{id:Number(s),title:t.meta.title,tags:t.meta.tags,publishDate:t.meta.publishDate,content:t.html,toc:t.tocTree,mode:!0})})};var Ne=t=>{const[n,r]=m.exports.useState([]),[c,s]=m.exports.useState("all"),{tag:l}=t;return m.exports.useEffect(()=>{console.log(l),l&&s(l)},[l]),m.exports.useEffect(()=>{me().then(a=>{r(a)})},[]),d("ul",{className:"tags",children:[e("li",{className:`${c==="all"?"selectedTag":""}`,children:e(C,{to:"/blog",onClick:a=>s("all"),children:"ALL"})}),n.map(a=>e("li",{className:`${c===a?"selectedTag":""}`,children:e(C,{to:"/blog/tag/"+a,onClick:()=>s(a),children:a})},a))]})};const z=(t,n)=>{const r=n=="left"?t-1:t+1;return d("div",{className:n=="left"?"post-left":"post-right",children:[n=="left"&&"\u25C0",e(C,{onClick:c=>window.scrollTo(0,0),to:{search:`?pageNumber=${r}`},children:n=="left"?"PREVIOUS":"NEXT"}),n=="right"&&"\u25B6"]})},P=20;var be=t=>{const{tag:n,pageNumber:r}=t,c=r*P,[s,l]=m.exports.useState([]),[a,g]=m.exports.useState([]);m.exports.useEffect(()=>{q().then(f=>l(f))},[]),m.exports.useEffect(()=>{const f=s.sort((N,A)=>new Date(N.publish_date)<new Date(A.publish_date)?1:-1).filter(N=>n?!!N.tags.includes(n):!0);g(f)},[s,n]);const y=f=>{const N=new Date(f),A=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],[x,F,S]=[A[N.getMonth()],N.getDate()+"TH",N.getFullYear()];return`${x} ${F} ${S}`};return s.length===0?e("h3",{children:"Loading..."}):d("div",{className:"posts",children:[e("ul",{className:"post-list",children:a.slice(c,c+P).map(f=>e("li",{children:d(C,{to:"/blog/post/"+f.id,children:[e("span",{className:"post-item-name",children:f.title}),e("span",{className:"post-item-date",children:y(f.publish_date)})]})},f.id))}),d("div",{className:"post-nav",children:[r>0&&z(r,"left"),r<a.length/P-1&&z(r,"right")]})]})};function ye(){const{search:t}=se();return m.exports.useMemo(()=>new URLSearchParams(t),[t])}const j=()=>{const t=H(),n=ye();return d("div",{className:"archive",children:[d("div",{className:"archive-tags",children:[e("h3",{children:"Tags"}),e(Ne,{tag:t.tag||""})]}),d("div",{className:"archive-list",children:[e("h3",{children:"List"}),e(be,{tag:t.tag||"",pageNumber:Number(n.get("pageNumber"))||0})]})]})};function Ae(t=300){if(t!==0)return{height:t+"px",width:t+"px",margin:"0 auto"}}var Ee=()=>{const[t,n]=m.exports.useState();return m.exports.useEffect(()=>{const r=document.getElementById("lifegame"),c=r.getContext("2d");if(!r||!c)return;const s=Math.round(r.offsetWidth/10)*10,l=s/10,a=10;c.fillStyle="#fff",c.fillRect(0,0,s,s);const g=f(l);r.addEventListener("mousemove",k),n(s);function y(o){const u=JSON.parse(JSON.stringify(o));i(u),S(o)}function f(o){const u=new Array(o);for(let h=0;h<o;h++){u[h]=new Array(o);for(let p=0;p<o;p++)u[h][p]=Math.round(Math.random())}return u}function N(o,u,h){let p=0;for(let E=o-1;E<=o+1;E++)for(let w=u-1;w<=u+1;w++)E>=0&&E<h.length&&w>=0&&w<h.length&&!(E===o&&w===u)&&(p+=h[E][w]===1?1:0);return p}function A(o,u,h){switch(N(o,u,h)){case 3:return g[o][u]=1,1;case 2:return-1;default:return g[o][u]=0,0}}function x(o,u){!c||(c.fillStyle="#111",c.fillRect(o*a,u*a,a*window.devicePixelRatio,a*window.devicePixelRatio))}function F(o,u){!c||(c.fillStyle="#fff",c.fillRect(o*a,u*a,a*window.devicePixelRatio,a*window.devicePixelRatio))}function S(o){const u=o.length;for(let h=0;h<u;h++)for(let p=0;p<u;p++)o[h][p]===1?x(h,p):F(h,p)}function k(o){const u=o.offsetX,h=o.offsetY,p=Math.floor(u/a),E=Math.floor(h/a);p<=0||E<=0||(p<l&&E<l&&(g[p][E]=1),S(g))}function i(o){const u=o.length;for(let h=0;h<u;h++)for(let p=0;p<u;p++)A(h,p,o)}let b=null;const v=o=>{b||(b=o);const u=o-b;u>60&&(b=o-u%60,y(g)),requestAnimationFrame(v)};return requestAnimationFrame(v),()=>r.removeEventListener("mousemove",k)},[]),e("div",{className:"lifegame-box",style:Ae(t),children:e("canvas",{id:"lifegame",width:t,height:t})})};var Ce=()=>d("div",{className:"guide",children:[e(Ee,{}),d("blockquote",{className:"quotoSICP",children:[e("p",{children:"\u300C\u5982\u679C\u8BF4\u827A\u672F\u89E3\u91CA\u4E86\u6211\u4EEC\u7684\u68A6\u60F3\uFF0C\u90A3\u4E48\u8BA1\u7B97\u673A\u5C31\u662F\u4EE5\u7A0B\u5E8F\u7684\u540D\u4E49\u6267\u884C\u7740\u5B83\u4EEC\u3002\u300D"}),e("i",{style:{textAlign:"right",fontStyle:"italic",fontSize:"14px"},children:"\u2014\u2014 Alan J.Perlis\u300A\u8BA1\u7B97\u673A\u7A0B\u5E8F\u7684\u6784\u9020\u4E0E\u89E3\u91CA\u300B"})]})]});const xe=()=>d("div",{className:"about",children:[e(Ce,{}),e("p",{children:e("a",{style:{textDecoration:"underline"},href:"https://github.com/lzcers",children:"My GitHub"})}),e("i",{children:"lzcers@gmail.com"})]}),X="https://api.github.com/repos/lzcers/docs/issues/114/comments",Le="https://api.github.com/repos/lzcers/docs/issues/comments";function T(){return localStorage.getItem("myToken")}function Se(){return T()?R.get(X,{headers:{Authorization:`token ${T()}`}}).catch(t=>(console.info("token check faild..."),[])):Promise.resolve([])}function we(t,n){const r={body:n};return R.patch(`${Le}/${t}`,{headers:{Authorization:`token ${T()}`},data:r}).catch(c=>(console.info("update record faild..."),[]))}function Fe(t){const n={body:t};return R.post(X,{headers:{Authorization:`token ${T()}`},data:n}).catch(r=>(console.info("create record faild..."),[]))}var ke=()=>{const[t,n]=m.exports.useState([]),[r,c]=m.exports.useState([]),[s,l]=m.exports.useState([]),[a,g]=m.exports.useState(null),y=m.exports.useRef(null),f=m.exports.useRef(null),N=()=>{Se().then(i=>{const b=i.map(v=>({id:v.id,tags:[],createdAt:new Date(v.created_at).toLocaleString(),updatedAt:new Date(v.updated_at).toLocaleString(),content:v.body})).reverse();c(b),l(b)})},A=()=>N(),x=i=>{localStorage.setItem("myToken",i),A()},F=i=>{if(!y.current)return;const b=M(B({},i),{content:y.current.value});c(r.map(v=>v.id==i.id?b:v)),we(i.id,y.current.value),g(null)},S=()=>{!f.current||!f.current.value||Fe(f.current.value).then(()=>{N(),f.current.value="",ae(0,f.current)})},k=m.exports.useCallback(i=>{l(r.filter(i))},[r]);return m.exports.useEffect(()=>{const i=r.reduce((v,o)=>{var h;const u=(h=o.updatedAt.match(/\d*\/\d*\/\d*/g))==null?void 0:h.pop();return u&&(v[u]?v[u].push(o):v[u]=[o]),v},{}),b=Object.keys(i).reverse().reduce((v,o)=>(v.push({date:o,count:i[o].length}),v),[]);n(b),l(r)},[r]),m.exports.useEffect(()=>{A()},[]),r.length==0?e("div",{className:"aranya",children:d("div",{className:"door",children:[e("p",{children:"\u975E\u516D\u6839\u6240\u89C1\uFF0C\u7740\u516D\u5C18\u800C\u663E\uFF0C\u51E1\u4E86\u609F\u8005\u5373\u77E5\u9053\u3002"}),e("input",{type:"text",className:"key",autoFocus:!0,onKeyUp:i=>{i.keyCode==13&&x(i.target.value)}})]})}):d("div",{className:"aranya",children:[d("div",{className:"heatmap",children:[e("div",{className:"left",children:t.map(i=>e("div",{className:"heatPoint",onClick:()=>{k(v=>v.updatedAt.includes(i.date))},style:{backgroundColor:`rgba(0, 160, 0, ${i.count/5<1?i.count/5:1})`}},i.date))}),d("div",{className:"count",onClick:()=>k(i=>!0),children:[e("span",{children:"\u5171"}),d("span",{children:[t.length," \u5929"]}),d("span",{children:[r.length," \u7B14"]})]})]}),e("div",{className:"tags"}),d("div",{className:"newRecord",children:[e(I,{className:"editArea post-body markdown-body",autoFocus:!0,ref:f,placeholder:"..."}),e("button",{className:"btn",onClick:S,children:e("strong",{children:"\u8BB0"})})]}),e("div",{className:"timeline",children:s.map(i=>d("div",{className:"record",children:[a!=i.id?e("div",{className:"content post-body markdown-body",dangerouslySetInnerHTML:{__html:Y(i.content).html}}):e(I,{className:"editArea post-body markdown-body",autoFocus:!0,defaultValue:i.content,ref:y,placeholder:"..."}),d("div",{className:"props",children:[d("div",{className:"opt",children:[a!=i.id&&e("button",{className:"btn",onClick:()=>g(i.id),children:"\u7F16\u8F91"}),a==i.id&&e("button",{className:"btn",onClick:()=>F(i),children:"\u4FDD\u5B58"}),a==i.id&&e("button",{className:"btn",onClick:()=>g(null),children:"\u53D6\u6D88"})]}),e("span",{className:"datetime",children:i.updatedAt})]})]},i.id))})]})};const Re=()=>d("nav",{className:"nav",children:[e("div",{className:"nav-header",children:e("h1",{className:"nav-sitename",children:e(C,{to:"/blog",children:d("div",{className:"nav-title",children:["\u5239",e("div",{className:"taijiBox",children:e("div",{className:"taiji"})}),"\u90A3"]})})})}),d("ul",{className:"nav-menu",children:[e("li",{className:"nav-item",children:e(C,{to:"/blog",children:"BLOG"})}),e("li",{className:"nav-item",children:e(C,{to:"/blog/aranya",children:"ARANYA"})}),e("li",{className:"nav-item",children:e(C,{to:"/blog/aboutme",children:"ABOUT"})})]})]});const De=()=>e("footer",{children:d("p",{children:[e("span",{children:"Copyright \xA9 KSANA 2017 - 2022"})," \xA0\xA0",e("a",{href:"https://beian.miit.gov.cn",children:"\u6D59ICP\u59072022004381\u53F7"})]})}),Te=()=>d(_,{children:[e(L,{path:"/",element:e(j,{})}),e(L,{path:"/tag/:tag",element:e(j,{})}),e(L,{path:"/post/:id",element:e(ve,{})}),e(L,{path:"/aboutme",element:e(xe,{})}),e(L,{path:"/aranya",element:e(ke,{})})]}),J=()=>d("div",{className:"container",children:[e(Re,{}),e("div",{className:"content",children:e(Te,{})}),e(De,{})]}),Be=()=>d(_,{children:[e(L,{path:"/",element:e(J,{})}),e(L,{path:"/blog/*",element:e(J,{})})]});oe.render(e(ce,{children:e(Be,{})}),document.getElementById("app"));
